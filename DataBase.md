# 数据库
### 1-如何优化索引？
1. 对常用字段建立索引，选择区分度大的字段
2. 前缀索引
3. 覆盖索引
4. 主键自增
5. 防止索引失效（or非索引列、联合索引非最左匹配、对索引列计算或函数、查询数据范围过大）

### 2-如何优化SQL语句？
__pre__: 开启慢查询日志```slow_query_log```

### 3-COMPACT行格式？
| 额外信息：变长字段长度列表；NULL值列表；头信息 | row id，tx id，row ptr（MVCC）；真实数据 |

一行最大65535字节，溢出后放在溢出页。

### 4-分库分表？
* 为什么要分库？
  * 磁盘存储：业务量剧增，拆分数据库，减少平均磁盘IO
  * 高并发：高并发下大量请求，减少每个库的连接数，分担读写压力
* 为什么要分表？
  * 单表数据量过大（千万级）遇到存储和查询性能瓶颈
* 如何选择分表键？
  * 用来分库、分表的字段，根据业务主题，比如用户ID，时间，地区等
* 非分表键如何查询？
  * 遍历（效率低）
  * 将数据冗余同步到ES，通过ES查询
